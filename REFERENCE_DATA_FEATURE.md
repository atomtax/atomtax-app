# 📋 물건목록 입력참고용 기능 추가

**구현 완료일**: 2026-02-11  
**버전**: 1.0

---

## 🎯 기능 개요

물건목록의 각 행에 **"입력참고용"** 버튼을 추가하여, 현재 입력된 데이터를 기반으로 **토지등 매매차익 예정신고서** 양식을 자동으로 생성하여 보여줍니다.

---

## 🔧 구현 내용

### **1️⃣ 버튼 추가**

**위치**: 서류 업로드 버튼 오른쪽

```
[서류 업로드] [입력참고용] [세금계산] [보고서] [삭제]
                   ↑
                 새로추가
```

**스타일**:
- 배경색: `#3b82f6` (파란색)
- 아이콘: `fa-info-circle`
- 텍스트: "입력참고용"

---

### **2️⃣ 모달 구조**

#### **헤더**:
```
📋 입력 참고용 - 토지등 매매차익 예정신고서
```

#### **안내 문구**:
```
현재 입력된 데이터를 기반으로 토지등 매매차익 예정신고서의 예상 값을 보여줍니다.
실제 신고 시에는 정확한 계산을 다시 확인해주세요.
```

---

### **3️⃣ 표시되는 표 (3개)**

#### **표 1: 토지등 매매차익 예정신고서**

| 구분 | 번호 | 금액 (원) |
|-----|------|-----------|
| 매매가액 (실거래가액) | 5 | 자동 계산 ✅ |
| 필요경비 | 6 | 자동 계산 ✅ |
| 경기보유특별공제 전 토지등매매차익 | 7 | (= 5 - 6) |
| 토지등 매매차익 | 8 | 자동 계산 ✅ |
| 기본공제(공제)된 매매차익합계액 | 9 | - |
| 토지등 매매차익 합계액(8+9) | 10 | 자동 계산 ✅ |
| **양도소득특별공제** | 11 | **15%** |
| 산출세액 | 12 | 자동 계산 ✅ |
| 가산세 | 13 | - |
| 기납부세액 | 14 | - |
| **납부할 종액 (12+13-14)** | 15 | 자동 계산 ✅ |
| 신고기한 내 납부할종액(15-16) | 17 | 자동 계산 ✅ |

**자동 계산 로직**:
```javascript
const salePrice = property.transfer_value || 0; // 매매가액
const requiredValue = property.acquisition_value + property.other_expenses; // 필요경비
const capitalGainValue = salePrice - requiredValue; // 토지등매매차익
const totalSpecialDeduction = Math.round(capitalGainValue * 0.15); // 양도소득특별공제 (15%)
const netCapitalGain = capitalGainValue - totalSpecialDeduction; // 순차익
```

---

#### **표 2: 부동산거래계약**

| 구분 | 내용 |
|-----|------|
| **(9) 거래일자** | |
| - 양도일 | `transfer_date` ✅ |
| - 취득일 | `acquisition_date` ✅ |
| **(10) 양도면적** | |
| - 토지 | `land_area` m² ✅ |
| - 건물 | `building_area` m² ✅ |
| - **충면적** | 토지 + 건물 ✅ |
| **(11) 매매가액** | `transfer_value` ✅ |

**데이터 소스**: 물건목록 각 행의 입력 데이터

---

#### **표 3: 필요경비**

| 구분 | 금액 |
|-----|------|
| (12) 취득가액 | `acquisition_value` ✅ |
| (13) 자본적 지출액 | - |
| (14) 양도비 | `disposal_cost` ✅ |
| (15) 감정자금충당이자 | - |
| (16) 공과금 | - |
| **(17) 필요경비 계 (11)-(17)** | 자동 계산 ✅ |
| **(11) - (17) 계** | 자동 계산 ✅ |
| (18) 경기보유특별공제 | - |
| **(19) 매매차익 (11)-(17)-(18)** | 자동 계산 ✅ |

---

#### **표 4: 신고 정보 요약**

```
┌─────────────────────┬──────────────────────┐
│ 양도일              │ 2025-01-15           │
│ 신고기한            │ 2025-03-31           │
│ 예정신고 과세표준    │ 43,000,000원         │
│ 납부세액 (15%)      │ 6,450,000원          │
└─────────────────────┴──────────────────────┘
```

---

## 📊 데이터 자동 매핑

### **매매사업자 데이터 → 신고서 양식**

| 물건목록 필드 | 신고서 필드 | 설명 |
|-------------|-----------|------|
| `transfer_value` | 매매가액 (5) | 양도가액 |
| `acquisition_value` | 취득가액 (12) | 취득 시 지출액 |
| `other_expenses` | 기타필요경비 | 취득세 등 |
| `disposal_cost` | 양도비 (14) | 중개수수료 등 |
| `transfer_date` | 양도일 | 거래 일자 |
| `acquisition_date` | 취득일 | 취득 일자 |
| `report_deadline` | 신고기한 | 자동 계산 |
| `land_area` | 토지 면적 | m² |
| `building_area` | 건물 면적 | m² |

---

## 💡 계산 공식

### **1. 필요경비 계 (17)**
```
필요경비 = 취득가액 + 기타필요경비 + 양도비
```

### **2. 토지등 매매차익 (8, 10)**
```
매매차익 = 매매가액 - 필요경비
```

### **3. 양도소득특별공제 (11)**
```
특별공제 = 매매차익 × 15%
```

### **4. 납부세액 (15)**
```
납부세액 = 특별공제액
```

---

## 🎨 UI 디자인

### **색상 구분**:
- 🟨 **노란색 (`#fef3c7`)**: 주요 입력 항목 (매매가액, 필요경비 계)
- 🟩 **초록색 (`#dcfce7`, `#f0fdf4`)**: 세금 관련 (양도소득특별공제, 납부액)
- 🟦 **파란색 (`#dbeafe`)**: 최종 매매차익
- ⬜ **회색 (`#f9fafb`)**: 일반 항목

### **아이콘**:
- 📅 달력 아이콘: 거래일자
- 💰 계산기 아이콘: 신고 정보
- ℹ️ 정보 아이콘: 안내 문구

---

## 🔄 데이터 흐름

```
1. 사용자가 물건목록에서 "입력참고용" 버튼 클릭
   ↓
2. showReferenceData(propertyIndex) 함수 실행
   ↓
3. inventoryRows[propertyIndex]에서 데이터 가져오기
   ↓
4. 자동 계산 수행
   - 필요경비 계 = 취득가액 + 기타필요경비 + 양도비
   - 매매차익 = 매매가액 - 필요경비
   - 양도소득특별공제 = 매매차익 × 15%
   - 납부세액 = 특별공제액
   ↓
5. HTML 테이블 생성 (3개 표)
   ↓
6. 모달 표시
```

---

## ✅ 구현 완료 항목

1. ✅ **"입력참고용" 버튼 추가** (서류 업로드 오른쪽)
2. ✅ **모달 창 구현** (HTML + 스타일)
3. ✅ **3개 표 자동 생성**:
   - 토지등 매매차익 예정신고서
   - 부동산거래계약
   - 필요경비
4. ✅ **자동 계산 로직**:
   - 필요경비 계
   - 토지등 매매차익
   - 양도소득특별공제 (15%)
   - 납부세액
5. ✅ **신고 정보 요약 섹션**
6. ✅ **데이터 자동 매핑** (물건목록 → 신고서)
7. ✅ **반응형 디자인** (테이블 스타일)
8. ✅ **모달 열기/닫기 기능**

---

## 📝 사용 예시

### **입력 데이터**:
```javascript
{
  property_name: "서울시 강남구 아파트",
  transfer_value: 740000000,      // 매매가액
  acquisition_value: 600000000,   // 취득가액
  other_expenses: 30000000,       // 기타필요경비
  disposal_cost: 10000000,        // 양도비
  transfer_date: "2025-01-15",
  acquisition_date: "2023-03-10",
  report_deadline: "2025-03-31",
  land_area: 21.75,
  building_area: 84.89
}
```

### **계산 결과**:
```
매매가액: 740,000,000원
필요경비: 640,000,000원 (600,000,000 + 30,000,000 + 10,000,000)
매매차익: 100,000,000원 (740,000,000 - 640,000,000)
양도소득특별공제 (15%): 15,000,000원
납부세액: 15,000,000원
```

---

## 🎯 장점

1. **자동 계산**: 수동 계산 불필요
2. **실시간 참조**: 입력 중 언제든지 확인 가능
3. **시각적**: 실제 신고서 양식과 유사한 디자인
4. **오류 방지**: 계산 실수 방지
5. **편의성**: 클릭 한 번으로 전체 신고서 미리보기

---

## 🚀 향후 개선 가능 사항

1. ⭐ PDF 다운로드 기능 추가
2. ⭐ 인쇄 기능 추가
3. ⭐ 여러 물건 일괄 신고서 생성
4. ⭐ 세율 테이블 연동 (15% 외 다른 세율)
5. ⭐ 경기보유특별공제 자동 계산

---

## 🎉 완료!

물건목록에서 **"입력참고용"** 버튼을 클릭하면 토지등 매매차익 예정신고서를 미리 볼 수 있습니다! 📋✨
