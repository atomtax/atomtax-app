# 📋 일괄업로드 양식 간소화 완료

## ✅ 완료된 수정사항

### 1️⃣ 물건목록 시트 (Sheet 1)

**제거된 컬럼:**
- ❌ **진행단계** (자동으로 "미확인"으로 설정)

**최종 컬럼 구조 (9개):**
1. 사업자번호* (필수)
2. 물건명
3. 소재지
4. 양도가액
5. 취득일(YYYYMMDD)
6. 양도일(YYYYMMDD)
7. 기납부 종소세
8. 기납부 지방소득세
9. **85초과(Y/N)** ⚠️ Y 또는 N만 입력 (필수)

**자동 계산 항목 (입력 불필요):**
- 취득가액 → 필요경비상세에서 자동 계산
- 기타필요경비 → 필요경비상세에서 자동 계산
- 양도소득 → 자동 계산 (양도가액 - 취득가액 - 기타필요경비)
- 신고기한 → 자동 계산 (양도일 + 2개월)

---

### 2️⃣ 필요경비상세 시트 (Sheet 2)

**최종 컬럼 구조 (6개):**
1. 사업자번호* (필수, 물건목록과 동일)
2. 물건명* (필수, 물건목록과 정확히 동일)
3. 비용명
4. **구분(취득가액/기타필요경비)** ⚠️ "취득가액" 또는 "기타필요경비"만 입력 (필수)
5. 금액
6. 비용인정(O/X)

**자동 처리 항목:**
- 번호 → 자동 넘버링 (1, 2, 3, ...)

---

## 🎯 입력 검증 규칙

### 85초과(Y/N)
```
✅ 허용: Y, N (대소문자 무관)
❌ 오류: YES, NO, 1, 0, 기타 문자
```

### 구분(취득가액/기타필요경비)
```
✅ 허용: 취득가액, 기타필요경비
❌ 오류: 취득, 기타, 1, 2, 기타 문자
```

**⚠️ 잘못된 값이 입력되면:**
- 85초과: 기본값 'N'으로 처리 + 콘솔 경고
- 구분: 해당 비용 항목 건너뜀 + 콘솔 경고

---

## 📝 작성 예시

### ✅ 올바른 예시 (물건목록)

**날짜 입력 방법 3가지 (모두 지원):**

```
방법 1: YYYYMMDD 형식 (권장)
취득일: 20230101
양도일: 20250115

방법 2: 엑셀 날짜 붙여넣기 (자동 변환)
취득일: 45700  ← 엑셀에서 복사한 날짜 (2025-02-08)
양도일: 45859  ← 자동으로 2025-07-17로 변환

방법 3: YYYY-MM-DD 형식
취득일: 2023-01-01
양도일: 2025-01-15
```

**전체 예시:**
```
사업자번호*     | 물건명              | 소재지           | 양도가액   | 취득일    | 양도일    | 기납부종소세 | 기납부지방소득세 | 85초과
123-45-67890 | 강남구 아파트      | 서울시 강남구... | 150000000 | 20230101 | 20250115 | 1500000    | 150000         | Y
123-45-67890 | 서초구 오피스텔    | 서울시 서초구... | 120000000 | 45700    | 45859    | 1000000    | 100000         | N
```

### ✅ 올바른 예시 (필요경비상세)
```
사업자번호*     | 물건명*         | 비용명      | 구분            | 금액     | 비용인정
123-45-67890 | 강남구 아파트   | 중개수수료  | 취득가액        | 1000000 | O
123-45-67890 | 강남구 아파트   | 취득세      | 취득가액        | 500000  | O
123-45-67890 | 강남구 아파트   | 수리비      | 기타필요경비    | 2000000 | X
```

### ❌ 잘못된 예시
```
❌ 85초과에 "YES" 입력 (Y만 가능)
❌ 구분에 "취득" 입력 ("취득가액" 전체 입력 필요)
❌ 물건명 불일치 ("강남구 아파트" vs "강남 아파트")
```

---

## 🚀 사용 방법

1. **양식 다운로드**
   - 매매사업자 데이터 페이지 → "📥 양식 다운로드" 버튼

2. **작성**
   - Sheet 1 (물건목록): 9개 컬럼 입력
   - Sheet 2 (필요경비상세): 6개 컬럼 입력
   - ⚠️ 물건명은 정확히 일치해야 함 (복사&붙여넣기 권장)

3. **업로드**
   - "📤 일괄 업로드" 버튼 클릭
   - 작성한 엑셀 파일 선택

4. **결과 확인**
   - 성공/실패 건수 확인
   - 매칭 실패 경고 확인
   - 페이지 새로고침

---

## 📊 변경 이력

### v3.1 (2026-01-30)
- ✅ 물건목록: 진행단계 제거 (자동 "미확인")
- ✅ 85초과(Y/N) 검증 강화
- ✅ 필요경비상세: 구분 검증 강화
- ✅ 드롭다운 대신 텍스트 입력 + 검증
- ✅ 잘못된 값 자동 처리 + 경고

### v3.0 (2026-01-29)
- ✅ 물건목록: 처분비, 양도소득 제거
- ✅ 기납부 종소세/지방소득세 추가
- ✅ 취득일 추가
- ✅ 신고기한 자동 계산

---

## 💡 개선 효과

| Before | After |
|--------|-------|
| 물건목록 13개 컬럼 | 물건목록 9개 컬럼 (-4개) |
| 진행단계 수동 입력 | 자동 "미확인" |
| 드롭다운 미지원 | 텍스트 입력 + 검증 |
| 에러 메시지 부족 | 상세 경고 메시지 |

**결과:**
- ✅ 더 간단한 입력
- ✅ 자동 계산 활용
- ✅ 명확한 검증 규칙
- ✅ 빠른 오류 수정

---

## 📌 주의사항

1. **85초과(Y/N)**
   - 반드시 Y 또는 N만 입력
   - 대소문자 구분 없음 (y, Y, n, N 모두 가능)

2. **구분(취득가액/기타필요경비)**
   - 반드시 전체 문자열 입력 ("취득가액" 또는 "기타필요경비")
   - 줄임말 불가 ("취득", "기타" ❌)

3. **물건명 매칭**
   - 띄어쓰기까지 정확히 일치
   - 복사&붙여넣기 권장
   - 엑셀 수식 활용 권장: `=물건목록!B2`

4. **날짜 형식**
   - 반드시 YYYYMMDD 형식 (권장)
   - 예: 20250115, 20230201
   - ✅ 엑셀 날짜 복사&붙여넣기도 지원! (시리얼 번호 자동 변환)
   - 예: 45700 → 2025-02-08, 45859 → 2025-07-17

---

완료! 🎉
