# 📅 엑셀 날짜 입력 가이드

## 문제 상황

엑셀에서 날짜를 복사&붙여넣기 하면 **시리얼 번호**로 표시되는 문제:

```
취득일(YYYYMMDD)    양도일(YYYYMMDD)
45700               45859
45761               45853
45988               
45988
```

**원인:**
- 엑셀은 날짜를 내부적으로 **숫자(시리얼 번호)**로 저장
- 1900년 1월 1일 = 1
- 2025년 2월 8일 = 45700

---

## ✅ 해결 완료!

이제 **3가지 날짜 형식**을 모두 지원합니다:

### 1️⃣ YYYYMMDD 형식 (권장)
```
취득일: 20230101
양도일: 20250115
```

**장점:**
- ✅ 가장 명확한 형식
- ✅ 엑셀에서도 텍스트로 인식

**입력 방법:**
1. 셀 서식을 **텍스트**로 설정
2. 20230101 입력

---

### 2️⃣ 엑셀 시리얼 번호 (자동 변환) ⭐ NEW
```
취득일: 45700  → 자동으로 2025-02-08로 변환
양도일: 45859  → 자동으로 2025-07-17로 변환
```

**장점:**
- ✅ 엑셀에서 날짜 그대로 복사&붙여넣기 가능
- ✅ 자동 변환되므로 수정 불필요

**입력 방법:**
1. 엑셀에서 날짜 입력 (예: 2025-02-08)
2. 그대로 복사&붙여넣기
3. 업로드 시 자동 변환

---

### 3️⃣ YYYY-MM-DD 형식
```
취득일: 2023-01-01
양도일: 2025-01-15
```

**장점:**
- ✅ 읽기 쉬운 형식

**입력 방법:**
1. 직접 입력: 2023-01-01
2. 엑셀 수식: `=TEXT(A2,"YYYY-MM-DD")`

---

## 📊 엑셀 시리얼 번호 변환 예시

| 시리얼 번호 | 실제 날짜 |
|------------|----------|
| 45700 | 2025-02-08 |
| 45761 | 2025-04-10 |
| 45859 | 2025-07-17 |
| 45853 | 2025-07-11 |
| 45988 | 2025-11-17 |

---

## 🎯 권장 방법

### 방법 A: 텍스트로 직접 입력 (가장 안전)

1. 엑셀에서 날짜 컬럼 선택
2. 셀 서식 → **텍스트**
3. 20230101 형식으로 입력

### 방법 B: 날짜 그대로 복사 (가장 편리)

1. 엑셀에서 날짜 입력 (2025-02-08)
2. 그대로 복사&붙여넣기
3. 시리얼 번호(45700)로 보여도 OK!
4. 업로드 시 자동 변환됨 ✅

---

## 🔍 변환 로직 설명

```javascript
// 엑셀 시리얼 번호 감지
if (숫자만 있고 && 4~6자리) {
    엑셀 날짜 시리얼일 가능성 있음
}

// 변환 공식
const excelEpoch = new Date(1899, 11, 30); // 1899-12-30
const jsDate = new Date(excelEpoch.getTime() + serialNumber * 24 * 60 * 60 * 1000);

// 예시: 45700
// = 1899-12-30 + 45700일
// = 2025-02-08
```

---

## ✅ 테스트 예시

### 입력 (엑셀)
```
사업자번호*     | 물건명          | 양도가액   | 취득일    | 양도일
123-45-67890 | 강남 아파트    | 150000000 | 45700    | 45859
123-45-67890 | 서초 오피스텔  | 120000000 | 20230201 | 20250220
```

### 변환 후 (시스템)
```
사업자번호*     | 물건명          | 양도가액   | 취득일        | 양도일
123-45-67890 | 강남 아파트    | 150000000 | 2025-02-08  | 2025-07-17
123-45-67890 | 서초 오피스텔  | 120000000 | 2023-02-01  | 2025-02-20
```

### 콘솔 로그
```
📅 엑셀 시리얼 변환: 45700 → 2025-02-08
📅 엑셀 시리얼 변환: 45859 → 2025-07-17
```

---

## 🚨 주의사항

### ❌ 잘못된 예시
```
취득일: 2025/02/08  ← 슬래시 사용 (변환 실패 가능)
양도일: 2.8.2025    ← 잘못된 형식
```

### ⚠️ 경고 메시지
```
⚠️ 날짜 형식 인식 실패: "2025/02/08"
```

---

## 💡 빠른 팁

1. **엑셀에서 날짜 복사**
   - 그대로 붙여넣기 하면 자동 변환 ✅

2. **YYYYMMDD로 바꾸고 싶다면**
   - 엑셀 수식: `=TEXT(A2,"YYYYMMDD")`
   - 예: 2025-02-08 → 20250208

3. **확인 방법**
   - 업로드 후 F12 → Console 탭
   - "📅 엑셀 시리얼 변환: ..." 메시지 확인

---

## 🎉 결론

이제 **엑셀에서 날짜를 어떻게 입력하든** 자동으로 처리됩니다!

1. ✅ 20230101 (YYYYMMDD)
2. ✅ 45700 (엑셀 시리얼)
3. ✅ 2023-01-01 (YYYY-MM-DD)

**가장 편한 방법으로 입력하세요!** 😊

---

완료! 🎉
